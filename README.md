# hive

蜂巢幼虫识别项目

## 使用方式
### 1 配置参数
打开`config.json`文件，请根据需求进行修改：  
```json
{
    "multipleCamera": true,     //是否开启双摄像头，true表示多摄像头，false表示单摄像头
    "diameterThreshold": 2.0,   //检测幼虫的直径阈值，小于这个阈值就会被捕捉，大于等于这个阈值则无信号输出，单位是mm
    "sleepTime": 1.0,           //向机械臂发送信号后，等待响应的时长
    "dojiOffset": 1.0,          //红色准星偏离蓝色准星的最大距离，单位是mm
    "resolution": [1920, 1080], //最终显示的分辨率，可以设置的分辨率：最小[640, 360]，最大[2592, 1944]，默认[1920, 1080]

    "preProcess": false,        //是否进行预处理，以下3项是预处理的参数，true是做预处理，false是不做预处理
    "topOffset": 0.0,           //预处理（上下偏移）：正数向下偏移，负数向上偏移
    "leftOffset": 0.0,          //预处理（左右偏移）：正数向右偏移，负数向左偏移
    "rotate": 0.0,              //预处理（绕中点旋转）

    // 上面的是可配置参数，下面的不做修改。
    "modelPath": {
        "rk3588": "./worm2.rknn",
        "rk3399pro": "./worm.rknn"
    },
    "gpio": {
        "rk3588": {
            "gpioPin": [[3, 5, 7], [8, 10, 12], [11, 13, 15], [19, 21, 23]],
            "gpioMap": {
                "3": 0,
                "5": 1,
                "7": 2,
                "8": 3,
                "10": 4,
                "12": 6,
                "11": 5,
                "13": 7,
                "15": 8,
                "19": 11,
                "21": 12,
                "23": 13
            }
        },
        "rk3399pro": {
            "gpioPin": [[3, 5, 7], [11, 13, 15], [19, 21, 23]],
            "gpioMap": {
                "3": 73,
                "5": 74,
                "7": 89,
                "11": 83,
                "13": 85,
                "15": 84,
                "19": 40,
                "21": 39,
                "23": 41
            }
        }
    }
}
```

### 2 运行程序
```shell
sudo python3 main.py
```
或者双击脚本`start.sh`运行  

### 3 更新项目
双击脚本`upgrade.sh`进行更新  

### 4 程序加密打包方式
运行`tools/setup.py`文件，代码如下：
```shell
cd tools
python3 setup.py build_ext
```
